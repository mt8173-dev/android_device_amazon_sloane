# zpppd_gprs - pppd process for ZTE 3gdongle ppp dail
type zpppd_gprs_exec, exec_type, file_type, vendor_file_type;
type zpppd_gprs, domain;

init_daemon_domain(zpppd_gprs)
net_domain(zpppd_gprs)

allow zpppd_gprs self:capability { setuid setgid net_admin net_raw dac_override sys_module };

# property service
set_prop(zpppd_gprs, radio_prop)
set_prop(zpppd_gprs, net_radio_prop)
set_prop(zpppd_gprs, system_radio_prop)
set_prop(zpppd_gprs, system_prop)
set_prop(zpppd_gprs, pppoe_ppp0_prop)
set_prop(zpppd_gprs, ctl_zpppdgprs_prop)


# device and file allow
allow zpppd_gprs tty_device:chr_file rw_file_perms;
#allow zpppd_gprs ppp_exec:file { read open getattr execute execute_no_trans };
allow zpppd_gprs ppp_device:chr_file { read write open ioctl };
allow zpppd_gprs system_file:file x_file_perms;
#allow zpppd_gprs shell_exec:file rx_file_perms;
allow zpppd_gprs vendor_shell_exec:file { read execute open execute_no_trans };

